@{
    ViewData["title"] = "Edycja pizzy";
}
@model Pizza

<section>
    <div class="row">
        <div class="mb-5 text-center row">
            <div class="col-1">
                <a class="btn btn-small btn-dark" asp-controller="Pizza" asp-action="PizzaDetails" asp-route-id="@TempData["id"]">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-left" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8.354 1.646a.5.5 0 0 1 0 .708L2.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z" />
                        <path fill-rule="evenodd" d="M12.354 1.646a.5.5 0 0 1 0 .708L6.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z" />
                    </svg>
                </a>
            </div>
            <div class="col-10">
                <h2>Edytuj pizzę: @Model.Name</h2>
            </div>
        </div>
        <div class="col-12 text-center mb-5">
            <img class="border-radius img-fluid" src="~/pizza_images/@Model.Name/@Model.ImagePath" href="Pizza">
        </div>
        <div class="col-12">
            <form method="post">
                <div class="row justify-content-center" style="min-height: 460px;">
                    <div class="accordion col-5 col-md-4 col-xl-2 p-0" id="accordionSize">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingOne">
                                <button class="accordion-button bg-light text-dark fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">Rozmiar</button>
                            </h2>
                            <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionSize">
                                <div class="accordion-body bg-light">
                                    <input class="sizeId" type="hidden" id="@Model.SizeId" value="@Model.SizeRadioPrice">

                                    <input type="radio" class="btn-check sizeRadio" id="20-sizeradio1" value="1" asp-for="SizeRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary  col-12" for="20-sizeradio1">mała</label>

                                    <input type="radio" class="btn-check sizeRadio" id="25-sizeradio2" value="2" asp-for="SizeRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2" for="25-sizeradio2">średnia</label>

                                    <input type="radio" class="btn-check sizeRadio" id="30-sizeradio3" value="3" asp-for="SizeRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2" for="30-sizeradio3">duża</label>

                                    <input type="radio" class="btn-check sizeRadio" id="35-sizeradio4" value="4" asp-for="SizeRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2 mb-2" for="35-sizeradio4">mega</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-5 col-md-4 col-xl-2 p-0" id="accordionDough">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button bg-light text-dark fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">Ciasto</button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#accordionDough">
                                <div class="accordion-body bg-light">
                                    <input class="doughId" type="hidden" id="@Model.DoughId" value="@Model.DoughRadioPrice">

                                    <input type="radio" class="btn-check doughRadio" id="3-doughradio1" value="1" asp-for="DoughRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12" for="3-doughradio1">cienkie</label>

                                    <input type="radio" class="btn-check doughRadio" id="6-doughradio2" value="2" asp-for="DoughRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2" for="6-doughradio2">grube</label>

                                    <input type="radio" class="btn-check doughRadio" id="9-doughradio3" value="3" asp-for="DoughRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2" for="9-doughradio3">ser w brzegach</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="accordion col-5 col-md-4 col-xl-2 p-0" id="accordionSauce">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingThree">
                                <button class="accordion-button bg-light text-dark fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">Sos do pizzy</button>
                            </h2>
                            <div id="collapseThree" class="accordion-collapse collapse show" aria-labelledby="headingThree" data-bs-parent="#accordionSauce">
                                <div class="accordion-body bg-light">
                                    <input class="sauceId" type="hidden" id="@Model.SauceId" value="@Model.SauceRadioPrice">

                                    <input type="radio" class="btn-check sauceRadio" id="2-sauceradio1" value="1" asp-for="SauceRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12" for="2-sauceradio1">sos pomidorowy</label>

                                    <input type="radio" class="btn-check sauceRadio" id="2-sauceradio2" value="2" asp-for="SauceRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2" for="2-sauceradio2">sos kremowy</label>

                                    <input type="radio" class="btn-check sauceRadio" id="2-sauceradio3" value="3" asp-for="SauceRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2" for="2-sauceradio3">sos pikantny pomidorowy</label>

                                    <input type="radio" class="btn-check sauceRadio" id="2-sauceradio4" value="4" asp-for="SauceRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2" for="2-sauceradio4">sos czosnkowy</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="accordion col-5 col-md-4 col-xl-2 p-0" id="accordionCheese">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingFour">
                                <button class="accordion-button bg-light text-dark fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseheadingFour" aria-expanded="false" aria-controls="collapseheadingFour">Ser</button>
                            </h2>
                            <div id="collapseheadingFour" class="accordion-collapse collapse show" aria-labelledby="headingheadingFour" data-bs-parent="#accordionCheese">
                                <div class="accordion-body bg-light">
                                    <input class="cheeseId" type="hidden" id="@Model.CheeseId" value="@Model.CheeseRadioPrice">

                                    <input type="radio" class="btn-check cheeseRadio" id="0-cheeseradio1" value="1" asp-for="CheeseRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12" for="0-cheeseradio1">mozzarella</label>

                                    <input type="radio" class="btn-check cheeseRadio" id="4-cheeseradio2" value="2" asp-for="CheeseRadio" autocomplete="off">
                                    <label class="btn btn-outline-secondary col-12 mt-2" for="4-cheeseradio2">podwójna mozzarella</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="accordion col-5 col-md-4 col-xl-2 p-0" id="accordionMeat">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingFive">
                                <button class="accordion-button bg-light text-dark fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">Mięso</button>
                            </h2>
                            <div id="collapseFive" class="accordion-collapse collapse show" aria-labelledby="headingFive" data-bs-parent="#accordionMeat">
                                <div class="accordion-body bg-light">
                                    @foreach (var element in Model.MeatId)
                                    {
                                        <input class="meatId" type="hidden" id="@element" value="@Model.MeatCheckboxPrice">
                                    }

                                    <input type="checkbox" class="btn-check meatCheckbox" id="5.2-meatcheck1" value="1" asp-for="MeatCheckbox1" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12" for="5.2-meatcheck1">pepperoni</label>

                                    <input type="checkbox" class="btn-check meatCheckbox" id="5.2-meatcheck2" value="2" asp-for="MeatCheckbox2" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5.2-meatcheck2">szynka</label>

                                    <input type="checkbox" class="btn-check meatCheckbox" id="5.2-meatcheck3" value="3" asp-for="MeatCheckbox3" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5.2-meatcheck3">wołowina</label>

                                    <input type="checkbox" class="btn-check meatCheckbox" id="5.2-meatcheck4" value="4" asp-for="MeatCheckbox4" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5.2-meatcheck4">wieprzowina</label>

                                    <input type="checkbox" class="btn-check meatCheckbox" id="5.2-meatcheck5" value="5" asp-for="MeatCheckbox5" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5.2-meatcheck5">kurczak</label>

                                    <input type="checkbox" class="btn-check meatCheckbox" id="5.2-meatcheck6" value="6" asp-for="MeatCheckbox6" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5.2-meatcheck6">boczek</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="accordion col-5 col-md-4 col-xl-2 p-0" id="accordionVegetable">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingSix">
                                <button class="accordion-button bg-light text-dark fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">Warzywa</button>
                            </h2>
                            <div id="collapseSix" class="accordion-collapse collapse show" aria-labelledby="headingSix" data-bs-parent="#accordionVegetable">
                                <div class="accordion-body bg-light">
                                    @foreach (var element in Model.VegetableId)
                                    {
                                        <input class="vegetableId" type="hidden" id="@element" value="@Model.VegetableCheckboxPrice">
                                    }

                                    <input type="checkbox" class="btn-check vegetableCheckbox" id="5-vegetablecheck1" value="1" asp-for="VegetableCheckbox1" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12" for="5-vegetablecheck1">kukurydza</label>

                                    <input type="checkbox" class="btn-check vegetableCheckbox" id="5-vegetablecheck2" value="2" asp-for="VegetableCheckbox2" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5-vegetablecheck2">oliwki</label>

                                    <input type="checkbox" class="btn-check vegetableCheckbox" id="5-vegetablecheck3" value="3" asp-for="VegetableCheckbox3" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5-vegetablecheck3">papryczki jalapenos</label>

                                    <input type="checkbox" class="btn-check vegetableCheckbox" id="5-vegetablecheck4" value="4" asp-for="VegetableCheckbox4" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5-vegetablecheck4">pieczarki</label>

                                    <input type="checkbox" class="btn-check vegetableCheckbox" id="5-vegetablecheck5" value="5" asp-for="VegetableCheckbox5" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5-vegetablecheck5">papryka</label>

                                    <input type="checkbox" class="btn-check vegetableCheckbox" id="5-vegetablecheck6" value="6" asp-for="VegetableCheckbox6" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5-vegetablecheck6">cebula</label>

                                    <input type="checkbox" class="btn-check vegetableCheckbox" id="5-vegetablecheck7" value="7" asp-for="VegetableCheckbox7" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5-vegetablecheck7">pomidory</label>

                                    <input type="checkbox" class="btn-check vegetableCheckbox" id="5-vegetablecheck8" value="8" asp-for="VegetableCheckbox8" autocomplete="off">
                                    <label class="btn btn-outline-dark col-12 mt-2" for="5-vegetablecheck8">rukola</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 mt-4 d-flex justify-content-center">
                    <div class="text-center shadow bg-light p-2 edit-price"></div>
                </div>
                <div class="col-12 row g-0 mt-5">
                    <div class="d-flex justify-content-center">
                        <button class="btn btn-small btn-dark ms-1" type="submit" asp-route-id="@Model.Id">Dodaj do koszyka</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>


<script>
    const sizeRadioChecked = document.querySelectorAll(".sizeRadio");
    const sizeIdChecked = document.querySelector(".sizeId");

    const doughRadioChecked = document.querySelectorAll(".doughRadio");
    const doughIdChecked = document.querySelector(".doughId");

    const sauceRadioChecked = document.querySelectorAll(".sauceRadio");
    const sauceIdChecked = document.querySelector(".sauceId");

    const cheeseRadioChecked = document.querySelectorAll(".cheeseRadio");
    const cheeseIdChecked = document.querySelector(".cheeseId");

    const meatCheckboxChecked = document.querySelectorAll(".meatCheckbox");
    const meatIdChecked = document.querySelectorAll(".meatId");

    const vegetableCheckboxChecked = document.querySelectorAll(".vegetableCheckbox");
    const vegetableIdChecked = document.querySelectorAll(".vegetableId");

    const editPrice = document.querySelector(".edit-price");

    let price = 0;
    let bool = false;

    let sizePrice = 0;
    let doughPrice = 0;
    let saucePrice = 0;
    let cheesePrice = 0;
    let meatPrice = 0;
    let vegetablePrice = 0;

    sizeRadioChecked.forEach(x => {

        if(x.value === sizeIdChecked.id){

            x.checked = true;
            sizePrice += parseInt(sizeIdChecked.value);
        }
    });

    doughRadioChecked.forEach(x => {

        if(x.value === doughIdChecked.id){

            x.checked = true;
            doughPrice += parseInt(doughIdChecked.value);
        }
    });

    sauceRadioChecked.forEach(x => {

        if(x.value === sauceIdChecked.id){

            x.checked = true;
            saucePrice += parseInt(sauceIdChecked.value);
        }
    });

    cheeseRadioChecked.forEach(x => {

        if(x.value === cheeseIdChecked.id){

            x.checked = true;
            cheesePrice += parseInt(cheeseIdChecked.value);
        }
    });

    meatCheckboxChecked.forEach(x => {

        meatIdChecked.forEach(y => {

            if(x.value === y.id){

                x.checked = true;

                if(bool === false){
                    bool = true;
                    meatPrice += parseInt(y.value) + 0.2 ;
                }
            }
        });
    });

    bool = false;

     vegetableCheckboxChecked.forEach(x => {

        vegetableIdChecked.forEach(y => {

            if(x.value === y.id){

                x.checked = true;

                 if(bool === false){
                    bool = true;
                    vegetablePrice += parseInt(y.value);
                }
            }

        });
    });

    const size = function(){

        let sizeRadioId = String(this.id);
        let sizeRadioSubstr = sizeRadioId.substr(0, sizeRadioId.indexOf("-"));
        let sizeRadioValue = Number(sizeRadioSubstr);

        if(this.checked === true){

            sizePrice = sizeRadioValue;
        }

        price = sizePrice + doughPrice + saucePrice + cheesePrice + meatPrice + vegetablePrice;
        editPrice.innerHTML = `<p class="fs-5 m-0 p-3">Wartość zamówienia: ${(Math.round(price*100)/100).toFixed(2)}zł</p>`;
    }

    const dough = function(){

        let doughRadioId = String(this.id);
        let doughRadioSubstr = doughRadioId.substr(0, doughRadioId.indexOf("-"));
        let doughRadioValue = Number(doughRadioSubstr);

        if(this.checked === true){

            doughPrice = doughRadioValue;
        }

        price = sizePrice + doughPrice + saucePrice + cheesePrice + meatPrice + vegetablePrice;
        editPrice.innerHTML = `<p class="fs-5 m-0 p-3">Wartość zamówienia: ${(Math.round(price*100)/100).toFixed(2)}zł</p>`;
    }

    const sauce = function(){

        let sauceRadioId = String(this.id);
        let sauceRadioSubstr = sauceRadioId.substr(0, sauceRadioId.indexOf("-"));
        let sauceRadioValue = Number(sauceRadioSubstr);

        if(this.checked === true){

            saucePrice = sauceRadioValue;
        }

        price = sizePrice + doughPrice + saucePrice + cheesePrice + meatPrice + vegetablePrice;
        editPrice.innerHTML = `<p class="fs-5 m-0 p-3">Wartość zamówienia: ${(Math.round(price*100)/100).toFixed(2)}zł</p>`;
    }

    const cheese = function(){

        let cheeseRadioId = String(this.id);
        let cheeseRadioSubstr = cheeseRadioId.substr(0, cheeseRadioId.indexOf("-"));
        let cheeseRadioValue = Number(cheeseRadioSubstr);

        if(this.checked === true){

            cheesePrice = cheeseRadioValue;
        }

        price = sizePrice + doughPrice + saucePrice + cheesePrice + meatPrice + vegetablePrice;
        editPrice.innerHTML = `<p class="fs-5 m-0 p-3">Wartość zamówienia: ${(Math.round(price*100)/100).toFixed(2)}zł</p>`;
    }

    const meat = function(){

        let meatCheckboxId = String(this.id);
        let meatCheckboxSubstr = meatCheckboxId.substr(0, meatCheckboxId.indexOf("-"));
        let meatCheckboxValue = Number(meatCheckboxSubstr);

        if(this.checked === true){

            meatPrice += meatCheckboxValue;
        }
        else{

            meatPrice -= meatCheckboxValue;
        }

        price = sizePrice + doughPrice + saucePrice + cheesePrice + meatPrice + vegetablePrice;
        console.log(price);
        editPrice.innerHTML = `<p class="fs-5 m-0 p-3">Wartość zamówienia: ${(Math.round(price*100)/100).toFixed(2)}zł</p>`;
    }

    const vegetable = function(){

        let vegetableCheckboxId = String(this.id);
        let vegetableCheckboxSubstr = vegetableCheckboxId.substr(0, vegetableCheckboxId.indexOf("-"));
        let vegetableCheckboxValue = Number(vegetableCheckboxSubstr);

        if(this.checked === true){

            vegetablePrice += vegetableCheckboxValue;
        }
        else{

            vegetablePrice -= vegetableCheckboxValue;
        }

        price = sizePrice + doughPrice + saucePrice + cheesePrice + meatPrice + vegetablePrice;
        editPrice.innerHTML = `<p class="fs-5 m-0 p-3">Wartość zamówienia: ${(Math.round(price*100)/100).toFixed(2)}zł</p>`;
    }

    sizeRadioChecked.forEach(x => {

        x.addEventListener("click", size);
    });

    doughRadioChecked.forEach(x => {

        x.addEventListener("click", dough);
    });

     sauceRadioChecked.forEach(x => {

        x.addEventListener("click", sauce);
    });

     cheeseRadioChecked.forEach(x => {

        x.addEventListener("click", cheese);
    });

     meatCheckboxChecked.forEach(x => {

        x.addEventListener("click", meat);
    });

     vegetableCheckboxChecked.forEach(x => {

        x.addEventListener("click", vegetable);
    });

    price = sizePrice + doughPrice + saucePrice + cheesePrice + meatPrice + vegetablePrice;
    console.log(price);
    editPrice.innerHTML = `<p class="fs-5 m-0 p-3">Wartość zamówienia: ${(Math.round(price*100)/100).toFixed(2)}zł</p>`;
</script>